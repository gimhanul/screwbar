# Routing Policies
Route 53이 DNS 쿼리에 응답하는 것을 도움

## Simple
- 단순
- 일반적으로 트래픽을 단일 리소스로 보내는 방식
- 동일한 레코드에 여러 개의 값을 지정할 수 있음
- 클라이언트가 다중 값을 받으면 무작위로 하나를 고름
- 별칭 레코드를 함께 사용하면, 하나의 AWS 리소스만을 대상으로 지정할 수 있음
- 상태 확인 불가능

## Weighted
- 가중치 기반
- 가중치를 활용해 요청의 일부 비율을 특정 리소스로 보내 제어함
- 각 레코드로 보내지는 트래픽의 양은 해당 레코드의 가중치를 전체 가중치로 나눈 값
	- 가중치가 70, 20, 10이라면 70%, 20%, 10%로 분배
	- 합이 100일 필요 x
- DNS 레코드는 동일한 이름과 유형을 가져야 함
- 상태 확인 가능
- Usecases: 서로 다른 지역에 걸쳐 로드밸런싱을 할 때, 적은 양의 트래픽을 보내 새 애플리케이션을 테스트할 때
- **0을 보내게 되면 특정 리소스에 트래픽 보내기를 중단할 수 있음**
- 모든 리소스 레코드 가중치의 값이 0이면 모두 동일한 가중치를 가지는 것임

## Latency Based
- 지연 시간 기반
- 지연 시간이 가장 짧은(=**가장 가까운**) 리소스로 보내는 정책
- 지연 시간에 민감한 웹사이트나 애플리케이션이 있는 경우 유용함
- 지연 시간은 유저가 레코드로 가장 가까운 식별된 AWS region에 연결하기까지 걸리는 시간을 기반으로 측정됨
- 상태 확인 가능

## Failover
- 장애 조치
- 보조 EC2 인스턴스 (재해 복구 EC2 인스턴스)를 두어서 장애를 대비함
- 상태 확인이 비정상이면 보조 EC2 인스턴스로 장애 조치하며 결과를 보냄
- 보조 EC2 인스턴스도 상태 확인을 연결할 수 있지만 기본과 보조가 각각 하나씩만 있을 수 있음
- 클라이언트의 DNS 요청은 정상으로 생각되는 리소스를 자동으로 얻음

## Geolocation
- 지리적
- 사용자의 실제 위치를 기반으로 함
- 사용자가 어디에 있는지 지정하고 가장 정확한 위치가 선택되어 그 IP로 라우팅함
- 일치하는 위치가 없는 경우 기본 `Default` 레코드를 생성함
- Use cases: 콘텐츠 분산을 제한하고 로드 밸런싱 등을 실행하는 웹사이트 현지화
- 상태 확인과 연결할 수 있음

## Geoproximity (using Route 53 Traffic Flow Feature)
- 지리 근접 라우팅
- 사용자와 리소스의 지리적 위치를 기반으로 트래픽을 리소스로 라우팅하도록 함
- 편향값을 사용해 특정 위치를 기반으로 리소스를 더 많은 트래픽을 이동함
- 지리적 위치를 변경하려면 편향값을 지정해야 함
	- 확장 (1 to 99) - 더 많은 트래픽
	- 축소 (-1 to -99) - 더 적은 트래픽
- 리소스:
	- AWS resources (특정 AWS region)
	- Non-AWS resources (위도와 경도 지정해야 함)
- 편향 활용을 위해 고급 Route 53 트래픽 플로우를 사용함

> 지리 근접 라우팅은 편향을 증가시켜
> 한 리전에서 다른 리전으로 트래픽을 보낼 때 유용함

## IP-based Routing
- IP 기반 라우팅
- 클라이언트 IP 주소를 기반으로 라우팅을 정의함
- CIDR 목록을 정의함 = 클라이언트의 IP 범위
- CIDR에 따라 트래픽을 어느 로케이션으로 보내야하는지 정함
- IP를 미리 알고 있기 때문에 성능 최적화 및 네트워크 비용 절감이 가능함
	- 특정 인터넷 제공업체가 특정 IP 주소 셋을 사용하는 걸 안다면 특정 엔드포인트로 라우팅할 수 있음

## Multi-Value Answer
- 다중 값 응답
- 트래픽을 다중 리소스로 라우팅할 때 사용함
- Route 53은 다중 값과 리소스를 반환함
- 최소 1개에서 최대 8개의 정상 레코드가 반환됨
- ELB와 유사해보이지만 대체할 수 없음 -> 클라이언트 측면의 로드 배런싱