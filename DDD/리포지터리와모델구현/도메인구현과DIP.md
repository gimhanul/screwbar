## 4.7. 도메인 구현과 DIP

이 장에서 구현한 리포지터리는 DIP 원칙을 어기고 있음.

JPA 에 특화된 `@Entity`, `@Table`, `@Id`, `@Column` 등의 애너테이션을 사용하고 있음.

DIP 에 따르면 `@Entity`, `@Table` 은 구현 기술에 속하므로 도메인 모델을 구현 기술인 JPA 에 의존하지 말아야 함.

리포지터리 인터페이스도 마찬가지임. 도메인 패키지에 위치하는 리포지토리가 스프링 데이터 JPA Repository 인터페이스를 상속하고 있음. 즉, 도메인이 인프라에 의존함.

구현 기술에 대한 의존 없이 도메인을 순수하게 유지하려면 스프링 데이터 JPA 의 Repository 인터페이스를 상속받지 않도록 수정하고, 해당 인터페이스를 구현한 클래스를 인프라에 위치시켜야 함. 또한, 도메인 모델에서 `@Entity` 나 `@Table` 과 같이 JPA 에 특화된 애너테이션을 모두 지우고 인프라에 JPA 를 연동하기 위한 클래스를 추가해야 함.

특정 기술에 의존하지 않는 순수한 도메인 모델을 추구하는 개발자는 ㄹㅇ 그렇게 함. 그 구졸ㄹ 가지면, 구현 기술을 변경하더라도 도메인이 받는 영향을 최소화 할 수 있음.

DIP 를 적용하는 주된 이유는 저수준 구현이 변경되더라도 고수준이 영향을 받지 않도록 하기 위함임. 하지만 리포지터리와 도메인 모델의 구현 기술은 거의 바뀌지 않음. 이렇게 변경이 거의 없는 상황에서 변경을 미리 대비하는 것은 과할지도 모름.

JPA 전용 애너테이션을 사용하긴 했지만, 도메인 모델을 단위 테스트하는 데는 문제가 없음.

DIP 를 완벽하게 지키면 좋겠지만, 개발 편의성과 실용성을 가져가면서 구조적인 유연함은 어느정도 유지함. 복잡도를 높이지 않으면서, 기술에 따른 구현 제약이 낮다면 합리적일 수도 있음.