## 9.5. 바운디드 컨텍스트 간 관계

바운디드 컨텍스트는 어떤 식으로든 연결되기 때문에 두 바운디드 컨텍스트는 다양한 방식으로 관계를 맺음.

가장 흔한 관계는 한쪽에서 API 를 제공하고, 다른 한쪽에서 그 API 를 호출하는 관계임.
이 관계에서 API 를 사용하는 바운디드 컨텍스트는(=상류 `upstream` 컴포넌트) API 를 제공하는 바운디드 컨텍스트에(=하류 `downstream` 컴포넌트) 의존하게 됨.

![](https://blog.kakaocdn.net/dn/ruspf/btrHqRAWkjP/8YV3cU4GQkWy69iP5cKQjK/img.png)

- 하류 컴포넌트는 상류 컴포넌트가 제공하는 데이터와 기능에 의존함.
- 상류 컴포넌트가 제공하는 REST API 의 인터페이스가 바뀌면 하류 컴포넌트의 코드도 바뀌게 됨.
- 고객과 공급자 관계에 있는 두 팀은 상호 협력이 필수적임.

<br>

### 공개 호스트 서비스 `Open Host Service`

상류 컴포넌트는 보통 하류 컴포넌트가 사용할 수 있는 통신 프로토콜을 정의하고 이를 공개함.

예를 들어 상류 컴포넌트는 하류 컴포넌트가 사용할 수 있는 REST API 를 제공하거나 프로토콜 버퍼 `Protocol Buffers` 와 같은 것을 이용해서 서비스를 제공할 수도 있음.

하류 팀이 다수 존재하면 상류 팀은 여러 하류 팀의 요구사항을 수용할 수 있는 API 를 만들고 이를 서비스 형태로 공개해서 서비스의 일관성을 유지할 수 있음.

이런 서비스를 가리켜 공개 호스트 서비스라 함.

<br>

### 완충 지대 `Anticorruption Layer`

상류 컴포넌트의 서비스는 상류 바운디드 컨텍스트의 도메인 모델을 따름.

따라서 하류 컴포넌트는 **상류 서비스의 모델이 자신의 도메인 모델에 영향을 주지 않도록 보호**해 주는 완충 지대를 만들어야 함.

![](https://velog.velcdn.com/images/mo-zza/post/68933daf-cd72-49d7-a99b-64d3d1c1d6c0/image.png)

여기서 RectSystemClient 는 외부 시스템이 모델 내 도메인 모델을 침범하지 않도록 막아주는 역할을 함.

즉, 내 모델이 깨지는 것을 막아주는 안티코럽션 계층이 됨.

이 계층에서 두 바운디드 컨텍스트 간의 **모델 변환**을 처리해 주기 떄문에 다른 바운디드 컨텍스트 모델에 영향을 받지 않고 내 도메인 모델을 유지할 수 있음.

<br>

### 공유 커널 `Shared Kernel`

두 바운디드 컨텍스트가 **같은 모델을 공유**하는 경우도 있음.

공유 커널의 장점은 중복을 줄여줌.
두 팀이 하나의 모델을 개발해서 공유하기 때문에 두 팀에서 동일한 모델을 두 번 개발하는 중복을 줄일 수 있음.

하지만 한 팀에서 임의로 모델을 변경하면 안 되며 두 팀이 밀접한 관계를 유지해야 함.

<br>

### 독립 방식 `Separate Way`

서로 통합하지 않는 방식임.

두 바운디드 컨텍스트 간에 통합하지 않으므로 서로 독립적으로 모델을 발전시킴.

독립 방식에서 두 바운디드 컨텍스트의 통합은 **수동**으로 이루어짐.

> 정보를 보고 사람이 직접 입력 등...

수동으로 통합하는 방식은 한계가 있으므로 규모가 커지기 시작하면 두 바운디드 컨텍스트를 통합해야 함.
두 바운디드 컨텍스트를 통합할 수 없다면, 이를 통합해 주는 별도의 시스템을 만들어야 할 수도 있음.