## 2.4. 도메인 영역의 주요 구성요소

도메인 영역의 모델은 도메인의 주요 개념을 표현하며 핵심 로직을 구현함.

### 도메인 영역의 주요 구성요소

| 요소                      | 설명                                                                                                               |
|-------------------------|------------------------------------------------------------------------------------------------------------------|
| 엔티티 `Entity`            | - 고유의 식별자를 갖는 객체.<br/>- 자신의 라이프 사이클을 가짐.<br/>- 도메인의 고유한 개념을 포기함.<br/>- 도메인 모델의 데이터를 포함하며 해당 데이터와 관련된 기능을 함께 제공함. |
| 밸류 `Value`              | - 고유의 식별자를 갖지 않는 객체<br/>- 주로 개념적으로 하나인 값을 표현할 때 사용됨.<br/>- 엔티티의 속성으로 사용할 뿐만 아니라 다른 밸류 타입의 속성으로도 사용함.             |
| 애그리거트 `Aggregate`       | - 연관된 엔티티와 밸류 객체를 개념적으로 하나로 묶은 것.                                                                                |
| 리포지터리 `Repository`      | - 도메인 모델의 영속성을 처리함.                                                                                              |
| 도메인 서비스 `Domain Service` | - 특정 엔티티에 속하지 않은 도메인 로직을 제공함.<br/>- 도메인 로직이 여러 엔티티와 밸류를 필요로 하면 도메인 서비스에서 로직을 구현함.                                |

<br>

### 엔티티와 밸류

실제 도메인 모델의 엔티티와 DB 관계형 모델의 엔티티는 같은 것이 아님.

도메인 모델의 엔티티는 DB 관계형 모델의 엔티티와는 다르게
- 데이터와 함께 기능을 제공함
- 도메인 관점에서 기능을 구현함
- 기능 구현을 캡슐화해서 데이터가 임의로 변경되는 것을 막음
- 두 개 이상의 데이터가 개념적으로 하나인 경우 밸류 타입을 이용해서 표현할 수 있음.

또한, 밸류는 불변으로 구현할 것을 권장하며, 이는 엔티티의 밸류 타입 데이터를 변경할 때는 객체 자체를 완전히 교체한다는 것을 의미함. 

<br>

### 애그리거트

도메인 모델도 개별 객체뿐만 아니라 상위 수준에서 모델을 볼 수 있어야 전체 모델의 관계와 개별 모델을 이해하는 데 도움이 됨. 도메인 모델에서 전체 구조를 이해하는 데 도움이 되는 것이 바로 애그리거트임.

애그리거트는 **관련 객체를 하나로 묶은 군집**임.

- 군집에 속한 객체를 관리하는 루트 엔티티를 가짐.
- 루트 엔티티는 애그리거트가 구현해야 할 기능을 제공함.
- 애그리거트를 사용하는 코드는 애그리거트 루트가 제공하는 기능을 실행하고 애그리거트 루트를 통해 간접적으로 애그리거트 내의 다른 엔티티나 밸류 객체에 접근함.
- 이것은 애그리거트의 내부 구현을 숨겨서 애그리거트 단위로 구현을 캡슐화할 수 있도록 도움.

<br>

### 리포지터리

도메인 객체를 지속적으로 사용하려면 물리적인 저장소에 도메인 객체를 보관해야 함. 이를 위한 도메인 모델이 리포지터리임.

도메인 모델 관점에서 `OrderRepository`는 도메인 객체를 영속화하는 데 필요한 기능을 추상화한 것으로 고수준 모듈에 속함. 기반 기술을 이용해서 `OrderRepository`를 구현한 클래스는 저수준 모듈로 인프라스트럭처 영역에 속함.

